@model Spinx.Domain.Quizs.Quiz
@{
    ViewBag.Title = Model.MetaTitle ?? Model.Title;
    ViewBag.MetaDescription = Model.MetaDescription ?? Model.ShortDescription;
}

<!-- Job Board: Page Banner Title -->
<section class="cmn-banner page-title-banner">
    <div class="imgDiv" style="background-image: url(Content/images/travel7.jpg);"></div>
    <div class="banner-title">
        <h1>Resources</h1>
    </div>
</section>

<!-- Job Board: Two column section  -->
<section class="cmn-banner-links">
    <div class="clearfix fix-wrap">
        <a href="javascript:void(0);" class="toggle-link">Filter</a>
        @Html.Partial("_ResourcesMenu")
    </div>
</section>

<section class="quiz-detail-wrap">
    <div class="clearfix fix-wrap">
        <div class="left-content">

            <div class="back-link">
                <a href="quiz">&lt; &nbsp;Quiz</a>
            </div>

            <div class="quiz-detail">
                <h2><img src="@Model.QuizCategory.CategoryIcon" width="24" alt="title-icon"/><span>@Model.Title</span></h2>
                <div class="short-desc">
                    <h3>Special Instructions:</h3>
                    <p>@Model.ShortDescription</p>
                </div>

                <div class="short-quiz">
                    <form method="post" onsubmit="CalculateResult(@ViewBag.QuizQuestions.Count);return false;">
                        @for (int i = 0; i < ViewBag.QuizQuestions.Count; i++)
                        {
                            <div class="form-group">
                                <div class="serial-no">@(i + 1)</div>
                                <div class="quiz-title">
                                    <h3>@ViewBag.QuizQuestions[i].Question</h3>
                                    @for (int j = 0; j < ViewBag.QuizQuestions[i].QuizAnswers.Count; j++)
                                    {
                                        <label class="custom-radio">
                                            <input value="@(j + 1)" type="radio" name="@(i + 1)"/>
                                            <img class="wrong-img" id="imgWrongAns@(i + 1)@(j + 1)" src="~/Content/images/wrong-icon.svg" style="display: none;"/>
                                            <img id="imgRightAns@(i + 1)@(j + 1)" src="~/Content/images/right-icon.svg" style="display: none;"/>
                                            <div class="checkmark">@ViewBag.QuizQuestions[i].QuizAnswers[j].Answer</div>
                                        </label>
                                        if (@ViewBag.QuizQuestions[i].QuizAnswers[j].IsCorrectAnswer)
                                        {
                                            <input type="hidden" data-qid="@(i + 1)" id="hdnAns@(i + 1)" value="@(j + 1)"/>
                                        }
                                    }

                                </div>
                            </div>
                        }
                        <div class="form-group btn-action" id="divSubmit">
                            <input type="submit" class="btn-primary" value="Submit for Evaluation"/>
                            <input type="reset" class="btn-primary btn-brdr" value="Clear Answers"/>
                        </div>
                        <div class="final-result" id="divResult" style="display: none;">Correctly Answered: <span id="spnResult"></span>%</div>
                    </form>
                </div>

            </div>
        </div>

    </div>
</section>

@section scripts{
    <script>
        $(document).ready(function () {
            filterLinks();
            $("#liQuizzes").addClass("active");
        });

        function CalculateResult(TotalQuestion) {
            var TotalCorrectAnswers = 0;

            for (var i = 1; i <= TotalQuestion; i++) {
                if ($("input:radio[name='" + i + "']:checked").val() == $("#hdnAns" + i).val() && $("#hdnAns" + i).val() != "" && typeof($("#hdnAns" + i).val()) !="undefined") {
                    $("#imgRightAns" + $("#hdnAns" + i).data("qid") + $("#hdnAns" + i).val()).show();
                    TotalCorrectAnswers++;
                }
                else {
                    $("input:radio[name='" + i + "']:checked").siblings(".wrong-img").show();
                    $("#imgRightAns" + $("#hdnAns" + i).data("qid") +  $("#hdnAns" + i).val()).show();
                }
                $("input:radio[name='" + i + "']").each(function () {
                    $(this).hide();
                    $(this).siblings("div").removeClass().addClass("uncheckmark");
                });
            }

            var finalResult = (TotalCorrectAnswers * 100) / TotalQuestion;
            $("#spnResult").html(parseInt(finalResult));
            $("#divSubmit").hide();
            $("#divResult").show();
        }

        function filterLinks() {
            var screen_width = $(window).width();

            if (screen_width < 979) {
                $(".cmn-banner-links ul.cmn-list").hide();
                $('a.toggle-link').off('click');
                $('a.toggle-link').on('click', function () {
                    $(this).toggleClass("open-filter");
                    $(".cmn-banner-links ul.cmn-list").slideToggle(200);
                });
            }
            else {
                $('a.toggle-link').removeClass("open-filter");
                $(".cmn-banner-links ul.cmn-list").show();
            }
        };

        $(window).resize(function () {
            filterLinks();
        });
    </script>
}